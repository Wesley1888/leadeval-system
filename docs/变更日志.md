# 变更日志

## [2025-01-XX] - 考核码使用状态优化

### 新增
- 为 `code` 表添加 `used` 字段，用于标记考核码是否已使用
- 新增 `/api/mark-used` 接口，用于标记考核码为已使用状态
- 优化登录逻辑，直接通过 `used` 字段判断考核码是否可用

### 修改
- 简化登录流程，移除复杂的打分完成检查逻辑
- 修改提交打分逻辑，完成后自动标记考核码为已使用
- 更新数据库设计文档，添加 `used` 字段说明和迁移脚本
- 更新接口文档，添加新的 `mark-used` 接口说明

### 删除
- 移除 `/api/score/finished` 接口和相关的 `checkFinished` 函数
- 移除前端登录时的复杂检查逻辑

### 技术优化
- 使用更简洁的 `used` 字段替代复杂的打分数量统计
- 提高系统性能，减少不必要的数据库查询
- 简化代码逻辑，提高可维护性

## [2025-01-XX] - 前端警告修复

### 修复
- 修复 antd Card 组件的 bodyStyle 警告，改为使用 styles.body
- 修复 Table 组件的 rowKey 警告，使用唯一字段作为 key
- 修复所有 TypeScript 类型不匹配警告
- 清理未使用的变量和导入

### 优化
- 改进前端类型安全性
- 优化组件性能
- 提升代码质量

## [2025-01-XX] - 管理员登录适配

### 修改
- 管理员登录接口从 `code+password` 改为 `name+password`
- 管理员登录查询 `person` 表而非 `code` 表
- 前端管理员登录页面适配新的登录方式

## [2025-01-XX] - 数据库结构升级：考核码分离

### 新增
- 重新设计数据库结构，实现考核码和被考核人分离
- 新增 `code` 表存储考核码信息
- 新增 `person` 表存储被考核人信息
- 新增 `department` 表存储部门信息

### 修改
- 重构所有后端接口，适配新的数据库结构
- 重构所有前端页面，适配新的数据结构
- 更新所有相关文档

### 删除
- 移除旧的 `user` 表相关字段
- 清理所有旧的数据结构引用

## [2025-01-XX] - 全局字段重命名

### 修改
- 将 `username` 统一重命名为 `name`
- 将 `department_id` 统一重命名为 `department`
- 将 `target_code` 统一重命名为 `target_id`
- 更新所有相关的前端页面、后端接口、SQL 查询和文档

## [2025-01-XX] - 前端状态持久化

### 新增
- 引入 React Router 进行路由管理
- 新增 AuthContext 进行用户状态管理
- 实现本地存储持久化登录状态
- 新增路由保护机制

### 修改
- 重构前端页面结构，支持路由导航
- 优化用户体验，解决刷新丢失状态问题

## [2025-01-XX] - 后端路由修复

### 修复
- 修复 Express 路由通配符导致的 path-to-regexp TypeError
- 优化 404 错误处理机制

## [2025-01-XX] - 项目初始化

### 新增
- 创建项目基础结构
- 实现基础的用户认证功能
- 实现基础的评分功能
- 创建项目文档体系 